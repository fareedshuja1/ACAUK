(function(){tinymce.PluginManager.requireLangPack("EasyPhotoAlbum");tinymce.PluginManager.add("EasyPhotoAlbum",function(e,d){var c;e.addButton("epa_insert",{tooltip:e.getLang("epa.dlg_title"),icon:"epa-dashicons epa-dashicons-insert-album",cmd:"epa_insert_album"});function b(g){if(undefined==c){var f="action=epa_get_albums&_ajax_nonce="+e.getLang("epa.nonce");tinymce.util.XHR.send({url:window.ajaxurl,data:f,content_type:"application/x-www-form-urlencoded",type:"POST",success:function(l){var j=[],k=tinymce.util.JSON.parse(l);for(var h=0;h<k.length;h++){j.push({text:k[h].title,value:k[h].id})}c=j;g(j)}})}else{g(c)}}function a(f){var g;g=e.windowManager.open({inline:true,id:"epa-insert",title:e.getLang("epa.dlg_title","Insert a photo album"),body:[{name:"albumid",type:"listbox",label:e.getLang("epa.select_album","Select an album to include"),autofocus:true,values:f},{name:"showtitle",type:"checkbox",text:e.getLang("epa.show_title","Show the title")},{name:"displaylabel",type:"label",text:e.getLang("epa.display_label","Display album like:")},{name:"excerpt",type:"radio",style:"cursor: pointer;",text:e.getLang("epa.excerpt","Excerpt"),checked:true,onClick:function(h){if(g.find("#excerpt").checked()){g.find("#full").checked(false)}else{g.find("#full").checked(true)}}},{name:"full",type:"radio",text:e.getLang("epa.full","Full album"),style:"cursor: pointer;",onClick:function(h){if(g.find("#full").checked()){g.find("#excerpt").checked(false)}else{g.find("#excerpt").checked(true)}}}],buttons:[{text:e.getLang("epa.insert","Insert"),onclick:"submit",classes:"btn primary"},{text:e.getLang("epa.cancel","Cancel"),onclick:"close"}],onSubmit:function(j){var h,k,i="excerpt";if(j.data.showtitle){k="true"}else{k="false"}if(j.data.full){i="full"}h='[epa-album id="'+j.data.albumid+'" show_title="'+k+'" display="'+i+'"]';e.selection.setContent(h)}})}e.addCommand("epa_insert_album",function(){var f=e.windowManager.open({inline:true,title:e.getLang("epa.title_loading","Loading..."),body:[{type:"label",text:e.getLang("epa.loading","Loading albums...")}],buttons:[{hidden:true}]});b(function(g){f.close();a(g)})})})})();